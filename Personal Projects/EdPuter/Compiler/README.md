# Edputer Compiler

This is the compiler I wrote in C++ using Flex and Bison to compile a C-like language into Edputer Assembly.

## Differences between C and Edputer-C

### Variable Declaration

The biggest difference between Edputer-C and regular C is that Edputer doesn't support local variables. This means that all variables are statically assigned a place in RAM. All variable declarations should be made in global space, and any attempt to declare a variable inside a function will result in a syntax error.

However, it is technically possible for the user to program local variables using the stack, but I decided to not implement this by default since the maximum code space for this program is merely 16 kilobytes. Having local variables and stack manipulation built in by default would likely take up a lot of space and be costly.

### Types

Given that Edputer is a barebones computer, there is no concept of types built in. The only type of value is a 16-bit unsigned integer. Any type discerning is up to the programmer. For example, you could consider values above 0 to be *true* and a value of 0 *false*, or you could consider a value of 0 to be the letter *a*, 1 to be *b*, and so on, but the values are still all considered integers to the compiler. 

### Edputer-C Specific Functions

There are three built-in functions to Edputer-C that pertain to graphics. 

The *vrammar()* function is used to set the Video RAM Memory Address Register. 

The *write()* function is used to write to VRAM at the location currently specified by the VRAM Memory Address Register.

The *flip* statement is used to flip the VRAM buffers. 

## Post Compiler

There are problems with the structure of Edputer programs that I cannot expect the compiler to fix during its initial pass. This is why I created the program *EdputerPostCompiler.py*. Its purpose is to clean up some inefficiencies generated by the compiler, and to fix issues with branching limitations.

### Multiple RET statements

One issue with the compiler is that sometimes functions have duplicate RET statements. I plan on fixing this problem at the root eventually, but for the time being, the post compiler simply removes subsequent RET statements to reduce the amount of wasted code space.

### Absolute Jumps and Relative Jumps

Since Edputer is a 16-bit computer, and only 8 bits of the instruction are for arguments, a CALL instruction can only jump to somewhere in the first 256 addresses in code memory. The post compiler determines if a CALL instruction is targeting somewhere past this range, and if so, changes the instruction to an LCALL instruction instead, and adds a pointer to its destination right at the beginning of code space.

Similarly, relative jumps can only jump forwards or backwards a maximum of 255 addresses. If the target location of the jump is past this range, additional "bridging" jumps are required. Basically, this program makes sure no JMP or CALL statements require an argument greater than 8 bits.
